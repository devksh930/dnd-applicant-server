= 전역 예외 처리(Global Exception)

:icons: font
:source-highlighter: coderay
:toc: left
:toclevels: 3
:sectlinks:
:sectnums:

link:index.html[← 목록으로]

애플리케이션 전반의 예외는 `GlobalExceptionHandler`에서 일관된 포맷으로 처리됩니다. 아래 문서는 공통 에러 구조와 대표적인 에러 사례들을 요청/응답 스니펫과 함께 제공합니다.

=== 공통 에러 응답 포맷

[discrete]
==== 응답 예시(필드)
// 대표 스니펫으로 validation 에러의 응답 필드 구조를 참고합니다.
include::{snippets}/error-validation/response-fields.adoc[]

=== 에러 코드 정의(ErrorCode)

아래 표는 서버에서 사용하는 전역 에러 코드(`ac.dnd.server.common.exception.ErrorCode`) 목록입니다.

==== Common (C)
|===
|HTTP Status|Code|Message

|422|C001|잘못된 입력값입니다
|405|C002|허용되지 않은 메서드입니다
|404|C003|리소스를 찾을 수 없습니다
|500|C004|서버 오류가 발생했습니다
|400|C005|잘못된 타입입니다
|403|C006|접근이 거부되었습니다
|===

==== Applicant (AP)
|===
|HTTP Status|Code|Message

|404|AP001|이름과 이메일을 다시 확인해주세요.
|422|AP002|합격자 조회 가능 기간이 지났습니다
|===

==== Event (EV)
|===
|HTTP Status|Code|Message

|404|EV001|이벤트를 찾을 수 없습니다.
|===

==== Auth (AU)
|===
|HTTP Status|Code|Message

|401|AU001|존재하지 않는 계정입니다
|403|AU002|인증되지 않은 사용자입니다
|401|AU003|올바르지 않은 인증 정보입니다
|===

==== Project (PJ)
|===
|HTTP Status|Code|Message

|404|PJ001|프로젝트를 찾을 수 없습니다
|422|PJ002|링크가 만료되었습니다
|404|PJ003|링크를 찾을 수 없습니다
|===

==== File (FL)
|===
|HTTP Status|Code|Message

|404|FL001|파일을 찾을 수 없습니다
|500|FL002|파일 업로드에 실패했습니다
|===

=== 400 잘못된 타입 값 (INVALID_TYPE_VALUE, C005)

요청 파라미터나 본문 필드의 타입 변환에 실패한 경우 발생합니다. 예: 숫자 필드에 문자열 전달.

[discrete]
==== 요청
include::{snippets}/error-type-mismatch/curl-request.adoc[]
include::{snippets}/error-type-mismatch/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-type-mismatch/http-response.adoc[]
include::{snippets}/error-type-mismatch/response-fields.adoc[]

=== 405 허용되지 않은 메서드 (METHOD_NOT_ALLOWED, C002)

엔드포인트가 허용하지 않는 HTTP 메서드로 호출한 경우 발생합니다. 예: GET만 허용인데 POST 요청.

[discrete]
==== 요청
include::{snippets}/error-method-not-allowed/curl-request.adoc[]
include::{snippets}/error-method-not-allowed/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-method-not-allowed/http-response.adoc[]
include::{snippets}/error-method-not-allowed/response-fields.adoc[]

=== 422 잘못된 입력값 (INVALID_INPUT_VALUE, C001)

Bean Validation 등 입력 값 검증에 실패한 경우 발생합니다. 필수값 누락, 형식 불일치 등을 포함합니다.

[discrete]
==== 요청
include::{snippets}/error-validation/curl-request.adoc[]
include::{snippets}/error-validation/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-validation/http-response.adoc[]
include::{snippets}/error-validation/response-fields.adoc[]

=== 404 비즈니스 예외 - 프로젝트를 찾을 수 없음 (PROJECT_NOT_FOUND, PJ001)

제공된 식별자/링크로 프로젝트를 조회하지 못한 경우 발생합니다.

[discrete]
==== 요청
include::{snippets}/error-business-not-found/curl-request.adoc[]
include::{snippets}/error-business-not-found/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-business-not-found/http-response.adoc[]
include::{snippets}/error-business-not-found/response-fields.adoc[]

=== 422 비즈니스 예외 - 링크 만료 (FORM_LINK_EXPIRED, PJ002)

프로젝트 제출을 위한 링크의 유효 기간이 만료된 경우 발생합니다.

[discrete]
==== 요청
include::{snippets}/error-business-expired/curl-request.adoc[]
include::{snippets}/error-business-expired/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-business-expired/http-response.adoc[]
include::{snippets}/error-business-expired/response-fields.adoc[]

=== 404 비즈니스 예외 - 링크를 찾을 수 없음 (FORM_LINK_NOT_FOUND, PJ003)

입력받은 링크 키에 해당하는 링크가 존재하지 않을 때 발생합니다.

[discrete]
==== 요청
include::{snippets}/error-business-link-not-found/curl-request.adoc[]
include::{snippets}/error-business-link-not-found/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-business-link-not-found/http-response.adoc[]
include::{snippets}/error-business-link-not-found/response-fields.adoc[]

=== 403 인증 예외 - 인증되지 않음 (UNAUTHENTICATED, AU002)

인증이 필요한 리소스에 인증 없이 접근한 경우 발생합니다.

[discrete]
==== 요청
include::{snippets}/error-auth-unauthenticated/curl-request.adoc[]
include::{snippets}/error-auth-unauthenticated/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-auth-unauthenticated/http-response.adoc[]
include::{snippets}/error-auth-unauthenticated/response-fields.adoc[]

=== 500 서버 내부 오류 (INTERNAL_SERVER_ERROR, C004)

예상치 못한 서버 내부 예외가 발생한 경우입니다. 재시도 후에도 지속되면 관리자에게 문의하세요.

[discrete]
==== 요청
include::{snippets}/error-internal/curl-request.adoc[]
include::{snippets}/error-internal/http-request.adoc[]

[discrete]
==== 응답
include::{snippets}/error-internal/http-response.adoc[]
include::{snippets}/error-internal/response-fields.adoc[]
